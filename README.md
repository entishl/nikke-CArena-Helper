# NIKKE 冠军竞技场应援助手

这是一个为游戏《胜利女神：妮姬》（NIKKE）的冠军竞技场（Champion Arena）模式设计的辅助工具。它通过自动化截图和图像处理，帮助玩家进行赛前分析、赛后复盘和阵容管理。

## 功能

*   **多模式操作**：提供多种模式以适应不同的比赛阶段和需求，包括应援、赛前分析、赛果复盘和图片处理。
*   **自动化截图**：自动识别并截取游戏窗口中的关键信息，如玩家阵容、对战结果等。
*   **图像拼接与处理**：将多张截图拼接成一张完整的图片，方便查看和分享。
*   **可配置延迟**：允许用户根据自己的电脑性能和网络状况调整操作延迟，以确保截图的准确性。
*   **多服务器支持**：支持国际服、港澳台服和国服。
*   **图形用户界面 (GUI)**：提供一个直观的图形界面，方便用户选择模式和启动脚本。

## 如何使用

1.  **以管理员权限运行**：为了与游戏窗口进行交互，程序需要以管理员权限运行。
2.  **打开游戏**：启动《胜利女神：妮姬》并进入对应界面（软件右边窗口有提示目标界面）。
3.  **选择服务器**：在GUI界面的下拉菜单中选择你所在的服务器。如果选择“自动”，程序将尝试自动检测游戏窗口。
4.  **选择模式**：根据你的需求，在左侧的模式列表中选择一个模式。界面右侧会显示该模式的指引图片。
5.  **启动脚本**：点击“启动脚本”按钮。程序会根据所选模式自动执行截图和处理任务。
6.  **查看结果**：处理完成的图片将保存在程序的 `output` 文件夹中。

## 模式说明

本工具提供以下几种核心模式：

### 应援专用
*   **应援助手-截取应援双方阵容 (模式 1)**: 截取并拼接出冠军竞技场中对战双方的阵容，用于预测和应援。
*   **应援复盘 (模式 2)**: 截取对战结果，用于复盘。
*   **应援助手-包含当前民意 (模式 3)**: 在截取双方阵容的同时，包含当前的应援情况（民意）。

### 赛前总览用
*   **小组赛模式 (模式 41)**: 截图小组赛中四名玩家的阵容和数据，并水平拼接。
*   **晋级赛8人阵容 (模式 4)**: 截取并拼接晋级赛阶段8名玩家的阵容。
*   **冠军赛8强阵容一览 (模式 5)**: 截取并拼接冠军赛8强玩家的阵容。

### 赛果分析用
*   **赛果：晋级赛（8组）(模式 6)**: 自动遍历并截取晋级赛所有8个小组的比赛结果。
*   **赛果：晋级赛（当前组）(模式 7)**: 截取当前查看的晋级赛小组的比赛结果。
*   **赛果：冠军八强赛 (模式 8)**: 截取冠军赛8强的对战结果。

### 其他
*   **图片处理与打包 (模式 9)**: 将指定文件夹内的图片转换为 WebP 格式以减小体积，并可选择性地打包成 ZIP 文件。

## 配置

你可以在 `config.json` 文件中自定义工具的行为。

*   **`delay_settings`**: 调整不同操作之间的延迟时间（秒）。如果你的电脑运行较慢或网络延迟较高，可以适当增加这些值。
    *   `gui_startup`: 点击“启动脚本”后的等待时间。
    *   `after_player_entry`: 点击玩家头像后的等待时间。
    *   `after_team_click`: 在队伍之间切换的等待时间。
    *   `after_click_player_details`: 进入玩家详情面板的等待时间。
*   **`global_settings`**: 全局设置，如输出文件的前缀、是否记录日志等。
*   **`modes_meta`**: 模式的元数据，你可以在这里禁用或修改模式的名称和描述。

## 注意事项

*   **管理员权限**：本程序必须以管理员权限运行，否则无法获取游戏窗口句柄和进行截图。
*   **游戏窗口**：在运行脚本时，请确保游戏窗口未被最小化，并且分辨率设置为 16:9，否则截图可能会失败或出现错误。
*   **前台窗口**：脚本运行时，会自动尝试将游戏窗口置于前台。请不要在脚本运行期间操作其他窗口，以免干扰截图。
*   **强制停止**：你可以随时按下 `Ctrl + 1` 快捷键来强制停止正在运行的脚本。